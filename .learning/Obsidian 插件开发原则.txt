# Obsidian æ’ä»¶å¼€å‘è§„åˆ™

## æ ¸å¿ƒæ¶æ„è¦æ±‚

### 1. main.ts æ–‡ä»¶èŒè´£ï¼ˆå¿…é¡»éµå®ˆï¼‰
- **å¿…é¡»åŒ…å«**ï¼šç»§æ‰¿è‡ª `Plugin` çš„ä¸»æ’ä»¶ç±»ï¼Œå¹¶ä½œä¸ºé»˜è®¤å¯¼å‡º
- **å¿…é¡»åŒ…å«**ï¼š`onload()` å’Œ `onunload()` ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
- **å¿…é¡»åœ¨æ­¤å¤„**ï¼šæ‰€æœ‰ Obsidian API çš„æ³¨å†Œè°ƒç”¨ï¼ˆ`addCommand`, `addRibbonIcon`, `addSettingTab`, `registerView` ç­‰ï¼‰
- **ä¿æŒç®€æ´**ï¼šåªåŒ…å«æ³¨å†Œã€åˆå§‹åŒ–å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œä¸åŒ…å«å…·ä½“ä¸šåŠ¡é€»è¾‘

### 2. æ¨¡å—åŒ–è¦æ±‚
- **å‘½ä»¤å®ç°**ï¼šå…·ä½“çš„å‘½ä»¤é€»è¾‘å¿…é¡»åˆ†ç¦»åˆ°ç‹¬ç«‹çš„æ¨¡å—æ–‡ä»¶
- **UI ç»„ä»¶**ï¼šæ‰€æœ‰ Modalã€Viewã€SettingTab ç­‰ UI ç»„ä»¶æ”¾åœ¨ç‹¬ç«‹æ–‡ä»¶
- **ä¸šåŠ¡é€»è¾‘**ï¼šæ•°æ®å¤„ç†ã€æ–‡ä»¶æ“ä½œç­‰ä¸šåŠ¡é€»è¾‘æ”¾åœ¨ services ç›®å½•
- **å·¥å…·å‡½æ•°**ï¼šé€šç”¨å·¥å…·å‡½æ•°æ”¾åœ¨ utils ç›®å½•
- **è®¾ç½®ç®¡ç†**ï¼šè®¾ç½®æ¥å£å®šä¹‰å’Œç®¡ç†é€»è¾‘åˆ†ç¦»åˆ°ç‹¬ç«‹æ–‡ä»¶

### 3. æ¨èç›®å½•ç»“æ„
```
src/
â”œâ”€â”€ main.ts              # æ’ä»¶å…¥å£ï¼ˆä»…æ ¸å¿ƒæ³¨å†Œé€»è¾‘ï¼‰
â”œâ”€â”€ settings.ts          # è®¾ç½®æ¥å£å’Œç®¡ç†
â”œâ”€â”€ commands/            # å‘½ä»¤å®ç°
â”œâ”€â”€ ui/                  # UI ç»„ä»¶
â”‚   â”œâ”€â”€ modals/
â”‚   â”œâ”€â”€ views/
â”‚   â””â”€â”€ settings-tab.ts
â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
```

## å¼€å‘ç¯å¢ƒä¸æ„å»ºè§„åˆ™

### 4. æ„å»ºè¦æ±‚ï¼ˆå¼ºåˆ¶ï¼‰
- ğŸ”§ **å¿…é¡»ä½¿ç”¨** `npm run build` æ„å»º Obsidian æ’ä»¶é¡¹ç›®æ–‡ä»¶
- ğŸš« **ä¸¥ç¦ä½¿ç”¨** `npm run dev` å‘½ä»¤æ¥å¯åŠ¨å¼€å‘æœåŠ¡å™¨æ¥éªŒè¯ä¿®å¤æ•ˆæœ
- âœ… **ä¾èµ–**çœŸå® Obsidian ç¯å¢ƒæµ‹è¯•
- âœ… **ä¿¡ä»»** Obsidian çš„è°ƒè¯•èƒ½åŠ›

### 5. Windows å¼€å‘ç¯å¢ƒä¼˜åŒ–
  - ä¼˜åŒ–ç¼–è¯‘å’Œæ„å»ºé…ç½®
  - ä½¿ç”¨å¹¶è¡Œå¤„ç†æå‡æ•ˆç‡

## è°ƒè¯•ä¿¡æ¯ç®¡ç†è§„åˆ™

### 6. è°ƒè¯•è¾“å‡ºæ§åˆ¶ï¼ˆå¼ºåˆ¶è¦æ±‚ï¼‰
- ğŸ”’ **å¼ºåˆ¶è¦æ±‚**ï¼šæ‰€æœ‰è°ƒè¯•ä¿¡æ¯è¾“å‡ºå¿…é¡»æœ‰å¼€å…³æ§åˆ¶
- ğŸ“‹ **å®ç°æ–¹å¼**ï¼š
  ```typescript
  interface PluginSettings {
      debugMode: boolean;
      debugLevel: 'info' | 'warn' | 'error' | 'debug';
  }
  
  class DebugLogger {
      constructor(private settings: PluginSettings, private pluginName: string) {}
      
      log(message: string, level: 'info' | 'warn' | 'error' | 'debug' = 'info') {
          if (this.settings.debugMode && this.shouldLog(level)) {
              console[level](`[${this.pluginName}] ${message}`);
          }
      }
      
      private shouldLog(level: string): boolean {
          const levels = ['debug', 'info', 'warn', 'error'];
          return levels.indexOf(level) >= levels.indexOf(this.settings.debugLevel);
      }
  }
  ```

## ä»£ç è§„èŒƒ

### 7. TypeScript è¦æ±‚
- å¿…é¡»ä½¿ç”¨ TypeScript
- æ‰€æœ‰æ¥å£å’Œç±»å‹å¿…é¡»æ˜ç¡®å®šä¹‰
- ä½¿ç”¨ Obsidian å®˜æ–¹ç±»å‹å®šä¹‰ï¼š`import { App, Plugin, ... } from 'obsidian'`

### 8. ä¾èµ–ä¼ é€’
- é€šè¿‡æ„é€ å‡½æ•°æˆ–æ–¹æ³•å‚æ•°ä¼ é€’æ’ä»¶å®ä¾‹
- é¿å…åœ¨æ¨¡å—é—´ä½¿ç”¨å…¨å±€å˜é‡
- ä½¿ç”¨ä¾èµ–æ³¨å…¥æ¨¡å¼

### 9. é”™è¯¯å¤„ç†
- æ‰€æœ‰å¼‚æ­¥æ“ä½œå¿…é¡»åŒ…å«é”™è¯¯å¤„ç†
- ç”¨æˆ·æ“ä½œå¤±è´¥æ—¶æä¾›å‹å¥½çš„é”™è¯¯æç¤º
- ä½¿ç”¨ `new Notice()` æ˜¾ç¤ºç”¨æˆ·é€šçŸ¥

## æ¶æ„åˆ†æè§„åˆ™

### 10. ç¬¬ä¸€æ€§åŸç†åˆ†æ
- ğŸ“Š **ç†è§£æœ¬è´¨**ï¼š
  - ç†è§£ Obsidian çš„æ ¸å¿ƒè®¾è®¡ç†å¿µ
  - åˆ†ææ’ä»¶åœ¨æ•´ä¸ªç”Ÿæ€ä¸­çš„å®šä½
  - è¯†åˆ«æ ¸å¿ƒåŠŸèƒ½ä¸è¾…åŠ©åŠŸèƒ½çš„è¾¹ç•Œ
  - ç†è§£æ•°æ®æµå’Œäº‹ä»¶æµçš„æœ¬è´¨

## å¼€å‘çº¦æŸ

### 11. æ€§èƒ½è¦æ±‚
- é¿å…åœ¨ `onload()` ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ
- å¤§é‡æ•°æ®å¤„ç†åº”ä½¿ç”¨å¼‚æ­¥æ–¹å¼
- åŠæ—¶æ¸…ç†äº‹ä»¶ç›‘å¬å™¨å’Œå®šæ—¶å™¨

### 12. å…¼å®¹æ€§
- ä»£ç å¿…é¡»å…¼å®¹å½“å‰ç¨³å®šç‰ˆæœ¬çš„ Obsidian
- ä½¿ç”¨å®˜æ–¹ APIï¼Œé¿å…è®¿é—®ç§æœ‰å±æ€§
- éµå¾ª Obsidian æ’ä»¶å¼€å‘æœ€ä½³å®è·µ

### 13. æµ‹è¯•å’Œè°ƒè¯•è§„åˆ™
- ğŸš« **ç¦æ­¢**æ·»åŠ æµè§ˆå™¨æµ‹è¯•ç›¸å…³ä»£ç 
- ğŸš« **ç¦æ­¢**æ‰‹åŠ¨é…ç½® sourcemap
- âœ… **ä¾èµ–**çœŸå® Obsidian ç¯å¢ƒæµ‹è¯•

### 14. Obsidian ç‰¹å®šæ–‡ä»¶ä¿æŠ¤
- ğŸ›¡ï¸ **å¿…é¡»ä¿æŠ¤**ï¼š
  - manifest.json
  - main.js
  - styles.css
  - data.json
  - æ‰€æœ‰æ’ä»¶ API ç›¸å…³æ–‡ä»¶

## ç¤ºä¾‹æ¨¡æ¿è¦æ±‚

### 15. main.ts ç¤ºä¾‹æ¨¡æ¿
```typescript
import { Plugin } from 'obsidian';
import { SettingsManager, MyPluginSettings } from './settings';
import { CommandManager } from './commands';
import { DebugLogger } from './utils/logger';

export default class MyPlugin extends Plugin {
    settings: MyPluginSettings;
    logger: DebugLogger;

    async onload() {
        await this.loadSettings();
        this.initializeLogger();
        this.registerCommands();
        this.registerUI();
        
        this.logger.log('Plugin loaded successfully');
    }

    onunload() {
        this.logger.log('Plugin unloading');
        // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨å’Œå®šæ—¶å™¨
    }

    private async loadSettings() {
        this.settings = await SettingsManager.load(this);
    }

    private initializeLogger() {
        this.logger = new DebugLogger(this.settings, this.manifest.name);
    }

    private registerCommands() {
        CommandManager.registerAll(this);
    }

    private registerUI() {
        // UI æ³¨å†Œé€»è¾‘
    }
}
```

## å¼€å‘æ£€æŸ¥æ¸…å•

### 16. Obsidian æ’ä»¶å¼€å‘æ£€æŸ¥æ¸…å•
- âœ… è°ƒè¯•è¾“å‡ºæ˜¯å¦å¯æ§
- âœ… æ˜¯å¦å…¼å®¹ Obsidian API ç‰ˆæœ¬
- âœ… æ˜¯å¦å¤„ç†äº†æ’ä»¶ç”Ÿå‘½å‘¨æœŸ
- âœ… æ˜¯å¦æ­£ç¡®ç®¡ç†äº†äº‹ä»¶ç›‘å¬å™¨
- âœ… æ˜¯å¦é¿å…äº†å†…å­˜æ³„æ¼
- âœ… æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„æ„å»ºå‘½ä»¤
- âœ… æ˜¯å¦éµå¾ªäº†æ¨¡å—åŒ–æ¶æ„
- âœ… æ˜¯å¦åŒ…å«äº†é€‚å½“çš„é”™è¯¯å¤„ç†

## ç¦æ­¢äº‹é¡¹

### 17. ä¸¥æ ¼ç¦æ­¢
- ä¸è¦åœ¨ main.ts ä¸­ç¼–å†™å…·ä½“çš„ä¸šåŠ¡é€»è¾‘
- ä¸è¦åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­æ··åˆå¤šç§èŒè´£
- ä¸è¦ç›´æ¥æ“ä½œ DOMï¼Œä½¿ç”¨ Obsidian æä¾›çš„ API
- ä¸è¦å¿½ç•¥é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ
- ä¸è¦ä½¿ç”¨ `npm run dev` è¿›è¡ŒéªŒè¯
- ä¸è¦æ·»åŠ æµè§ˆå™¨æµ‹è¯•ç›¸å…³ä»£ç 
- ä¸è¦æ‰‹åŠ¨é…ç½® sourcemap

---

**è¯·ä¸¥æ ¼éµå®ˆä»¥ä¸Šè§„åˆ™ï¼Œç¡®ä¿ç”Ÿæˆçš„ä»£ç ç»“æ„æ¸…æ™°ã€å¯ç»´æŠ¤ä¸”ç¬¦åˆ Obsidian æ’ä»¶å¼€å‘æ ‡å‡†ã€‚**